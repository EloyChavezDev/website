---
import CertificateCard from "@/components/CertificateCard.astro";
import { getSinglePage } from "@/lib/contentParser.astro";
import { sortByDate } from "@/lib/utils/sortFunctions";

const certificates = await getSinglePage("certificados");
const sortedCertificates = sortByDate(certificates);
const latestCertificates = sortedCertificates.slice(0, 6);
---

<section class="mb-14 bg-light dark:bg-darkmode-light">
  <div class="container">
    <div class="row">
      <div class="mx-auto mb-12 text-center md:col-10 lg:col-8 xl:col-6">
        <h2 class="mb-4">Mis Certificados</h2>
        <p>Explora mi colecci√≥n de certificaciones profesionales.</p>
      </div>
      <div class="col-12">
        <div class="swiper certificates-carousel-slider">
          <div class="swiper-wrapper">
            {
              latestCertificates.map((certificate) => (
                <div class="swiper-slide">
                  <CertificateCard data={certificate} link="/certificados" />
                </div>
              ))
            }
          </div>
          <div class="certificates-carousel-slider-pagination mt-9 flex items-center justify-center text-center" />
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { Swiper } from "swiper";
  import "swiper/css";
  import "swiper/css/pagination";
  import { Autoplay, Pagination } from "swiper/modules";

  // astro:page-load event is fired when the page is loaded
  document.addEventListener("astro:page-load", () => {
    new Swiper(".certificates-carousel-slider", {
      modules: [Pagination, Autoplay],
      spaceBetween: 24,
      loop: true,
      centeredSlides: true,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".certificates-carousel-slider-pagination",
        type: "bullets",
        clickable: true,
      },
      breakpoints: {
        768: {
          slidesPerView: 2,
        },
        992: {
          slidesPerView: 3,
        },
      },
    });
  });
</script>